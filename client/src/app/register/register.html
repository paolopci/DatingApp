<form [formGroup]="registerForm" (ngSubmit)="register()" autocomplete="off">
    <h2 class="text-center text-primary">Sign Up</h2>
    <hr>

    <!-- Username -->
    <app-text-input [control]="$any(registerForm.get('username'))" [label]="'Username'" [type]="'text'"
        [requiredMessage]="'Username is required'" />

    <!-- Password -->
    <app-text-input [control]="$any(registerForm.get('password'))" [label]="'Password'" [type]="'password'"
        [id]="'password'" />

    <!-- Confirm Password -->
    <app-text-input [control]="$any(registerForm.get('confirmPassword'))" [label]="'Confirm Password'"
        [type]="'password'" [id]="'confirmPassword'">
        <!-- Mismatch impostato sul controllo -->
        @if (registerForm.get('confirmPassword')?.hasError('notMatching') && registerForm.get('confirmPassword')?.touched) {
        <div class="invalid-feedback text-start">Le password non coincidono</div>
        }
        <!-- Mismatch impostato a livello di form -->
        @if ((registerForm.hasError('notMatching') || registerForm.hasError('passwordMismatch')) &&
        registerForm.get('confirmPassword')?.touched) {
        <div class="invalid-feedback text-start">Le password non coincidono</div>
        }
    </app-text-input>

    <!-- Bottoni -->
    <div class="form-group text-center">
        <button type="submit" class="btn btn-primary">Register</button>
        <button type="button" class="btn btn-default" (click)="cancel()">Cancel</button>
    </div>
</form>

<!-- Debug -->
<p>Form value: {{ registerForm.value | json }}</p>
<p>Form status: {{ registerForm.status | json }}</p>
